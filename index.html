<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KKU Bus Route Logger</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2196F3">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header>
            <h1>KKU Bus Logger</h1>
            <div class="status-bar">
                <span id="current-time" class="time"></span>
                <span id="trip-status" class="trip-info"></span>
            </div>
        </header>

        <!-- Setup Phase -->
        <section id="setup-phase" class="phase">
            <div class="card">
                <h2>Trip Setup</h2>
                
                <div class="form-group">
                    <label>Route Color *</label>
                    <div class="route-buttons">
                        <button type="button" class="route-btn route-Red" data-route="Red">Red</button>
                        <button type="button" class="route-btn route-Yellow" data-route="Yellow">Yellow</button>
                        <button type="button" class="route-btn route-Blue" data-route="Blue">Blue</button>
                        <button type="button" class="route-btn route-Green" data-route="Green">Green</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="plate-input">Bus Plate Number</label>
                    <input type="text" id="plate-input" placeholder="e.g., ‡∏Å‡∏ó-1234">
                </div>
                
                <div class="form-group">
                    <label for="weather-select">Weather</label>
                    <select id="weather-select">
                        <option value="">Select weather</option>
                        <option value="sunny">üåû Sunny</option>
                        <option value="cloudy">‚òÅÔ∏è Cloudy</option>
                        <option value="rainy">üåßÔ∏è Rainy</option>
                        <option value="stormy">‚õàÔ∏è Stormy</option>
                    </select>
                </div>
                
                <button id="start-trip-btn" class="btn btn-primary" disabled>Start Trip</button>
            </div>
        </section>

        <!-- Logging Phase -->
        <section id="logging-phase" class="phase hidden">
            <!-- Stop ID Display -->
            <div class="stop-display">
                <div id="stop-tile" class="stop-tile">
                    <span id="stop-label">R1</span>
                </div>
            </div>

            <!-- Stop Activity Form -->
            <div class="card">
                <h3>Stop Activity</h3>
                
                <div class="status-buttons">
                    <button type="button" class="status-btn pickup-btn" data-status="picked-up">Stopped to pick up</button>
                    <button type="button" class="status-btn pass-btn" data-status="passed">Passed without picking up</button>
                </div>
                
                <div class="form-group">
                    <label for="notes-input">Notes (optional)</label>
                    <textarea id="notes-input" placeholder="Additional notes..." rows="2"></textarea>
                </div>
                
                <button id="done-btn" class="btn btn-primary btn-large">Done</button>
            </div>


            <!-- Control Bar -->
            <div class="control-bar">
                <button id="skip-btn" class="btn btn-secondary btn-sm">Skip</button>
                <button id="back-btn" class="btn btn-secondary btn-sm">Go Back</button>
                <button id="custom-stop-btn" class="btn btn-secondary btn-sm">Custom Stop</button>
                <button id="reset-btn" class="btn btn-danger btn-sm">Reset Trip</button>
            </div>
        </section>

        <!-- Data Display Section -->
        <section id="data-section" class="card">
            <div class="section-header">
                <h3>Trip Data</h3>
                <div class="data-actions">
                    <button id="clear-all-btn" class="btn btn-danger btn-sm">Clear All</button>
                    <button id="export-csv-btn" class="btn btn-outline btn-sm">CSV</button>
                    <button id="export-json-btn" class="btn btn-outline btn-sm">JSON</button>
                </div>
            </div>
            
            <div id="entries-count" class="count">0 entries</div>
            
            <div class="table-container">
                <table id="data-table">
                    <thead>
                        <tr>
                            <th>Timestamp</th>
                            <th>Time</th>
                            <th>Day</th>
                            <th>Stop</th>
                            <th>Status</th>
                            <th>Notes</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="data-tbody">
                        <!-- Entries will be inserted here -->
                    </tbody>
                </table>
            </div>
            
            <div id="no-data" class="no-data hidden">
                <p>No entries yet</p>
            </div>
        </section>
    </div>

    <!-- Edit Entry Modal -->
    <div id="edit-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Entry</h3>
                <button id="close-edit-modal" class="close-btn">&times;</button>
            </div>
            
            <div class="form-group">
                <label for="edit-stop-id">Stop ID</label>
                <input type="text" id="edit-stop-id" readonly>
            </div>
            
            <div class="form-group">
                <label for="edit-status">Status</label>
                <select id="edit-status">
                    <option value="picked-up">Stopped to pick up</option>
                    <option value="passed">Passed without picking up</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="edit-notes">Notes</label>
                <textarea id="edit-notes" rows="3"></textarea>
            </div>
            
            <div class="modal-actions">
                <button id="delete-entry-btn" class="btn btn-danger">Delete</button>
                <button id="cancel-edit-btn" class="btn btn-secondary">Cancel</button>
                <button id="save-edit-btn" class="btn btn-primary">Save</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Dialog -->
    <div id="confirm-dialog" class="modal hidden">
        <div class="modal-content">
            <h3 id="confirm-title">Confirm Action</h3>
            <p id="confirm-message">Are you sure?</p>
            <div class="modal-actions">
                <button id="confirm-cancel" class="btn btn-secondary">Cancel</button>
                <button id="confirm-ok" class="btn btn-primary">Confirm</button>
            </div>
        </div>
    </div>
    
    <!-- Custom Stop Input Modal -->
    <div id="custom-stop-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Enter Custom Stop Number</h3>
                <button id="close-custom-stop-modal" class="close-btn">&times;</button>
            </div>
            
            <div class="form-group">
                <label for="custom-stop-input">Stop Number</label>
                <input type="number" id="custom-stop-input" pattern="[0-9]*" inputmode="numeric" min="1" placeholder="Enter stop number">
            </div>
            
            <div class="modal-actions">
                <button id="cancel-custom-stop-btn" class="btn btn-secondary">Cancel</button>
                <button id="confirm-custom-stop-btn" class="btn btn-primary">Set Stop</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>